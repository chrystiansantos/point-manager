import { expect, test } from "@playwright/test";

test.describe("Listar marcadores", () => {
  // O teste foi realizado com sucesso; no entanto, é necessário desativar o
  //  MSW para que o retorno funcione corretamente.
  test("Listar todos os pontos dentro de suas respectivas áreas", async ({
    page,
  }) => {
    await page.route("http://localhost:3333/area", async (route) => {
      const json = [
        {
          id: "1746760363845",
          name: "área-1",
          position: [
            {
              lat: -15.17822700163232,
              lng: -53.59131240844727,
            },
            {
              lat: -15.185267993192468,
              lng: -53.588994979858406,
            },
            {
              lat: -15.183476689054984,
              lng: -53.58202126816443,
            },
            {
              lat: -15.183021098722811,
              lng: -53.581935437475956,
            },
            {
              lat: -15.18242054632833,
              lng: -53.58184960678748,
            },
            {
              lat: -15.182016626667593,
              lng: -53.58178039838012,
            },
            {
              lat: -15.18177847565155,
              lng: -53.58173748303588,
            },
            {
              lat: -15.181473020694288,
              lng: -53.58168920327361,
            },
            {
              lat: -15.181219337427791,
              lng: -53.581608737003165,
            },
            {
              lat: -15.181007071603265,
              lng: -53.58156582165893,
            },
            {
              lat: -15.180903527221192,
              lng: -53.58151754189666,
            },
            {
              lat: -15.180691261079199,
              lng: -53.581372702609855,
            },
            {
              lat: -15.180416867945322,
              lng: -53.58127077866729,
            },
            {
              lat: -15.180194246838868,
              lng: -53.581115210544425,
            },
            {
              lat: -15.179919853059173,
              lng: -53.58098110009368,
            },
            {
              lat: -15.179635104420248,
              lng: -53.580873811733085,
            },
            {
              lat: -15.179402127975544,
              lng: -53.58077188779052,
            },
            {
              lat: -15.179101846845487,
              lng: -53.580632412921744,
            },
            {
              lat: -15.178863692542187,
              lng: -53.58054121781524,
            },
            {
              lat: -15.178780856199833,
              lng: -53.580498302471,
            },
            {
              lat: -15.17869801982497,
              lng: -53.58032664109405,
            },
            {
              lat: -15.17792142723065,
              lng: -53.57944151211913,
            },
            {
              lat: -15.176275041487079,
              lng: -53.5773279314154,
            },
            {
              lat: -15.176184306575825,
              lng: -53.577277915710795,
            },
            {
              lat: -15.176135121877515,
              lng: -53.577251093620646,
            },
            {
              lat: -15.176070405151782,
              lng: -53.57721354269444,
            },
            {
              lat: -15.176000511065707,
              lng: -53.57718135618626,
            },
            {
              lat: -15.175909907586384,
              lng: -53.57713844084202,
            },
            {
              lat: -15.175816715395682,
              lng: -53.57713844084202,
            },
            {
              lat: -15.174965334584824,
              lng: -53.57731097940436,
            },
            {
              lat: -15.172790829700217,
              lng: -53.5778581500434,
            },
            {
              lat: -15.176135416045973,
              lng: -53.58707422021857,
            },
            {
              lat: -15.177305491025688,
              lng: -53.59046453241339,
            },
            {
              lat: -15.177455597475731,
              lng: -53.591010646387254,
            },
            {
              lat: -15.17750219321468,
              lng: -53.59111793474785,
            },
            {
              lat: -15.177517725125389,
              lng: -53.591225223108445,
            },
            {
              lat: -15.17753325703495,
              lng: -53.59127350287071,
            },
            {
              lat: -15.177587618709406,
              lng: -53.591335193678056,
            },
            {
              lat: -15.177631625768962,
              lng: -53.5913968844854,
            },
            {
              lat: -15.177735171755268,
              lng: -53.59142907099358,
            },
          ],
          pins: [
            {
              id: "1746760367905",
              name: "1",
              position: {
                lat: -15.178774724043482,
                lng: -53.58289658808763,
              },
              createdAt: "2025-05-09T03:12:47.905Z",
            },
          ],
          center: {
            lng: -53.58289658808763,
            lat: -15.178774724043482,
          },
        },
      ];
      await route.fulfill({
        json,
        status: 200,
        contentType: "application/json",
      });
    });

    await page.goto("http://localhost:3000", { waitUntil: "networkidle" });

    await expect(page.getByText("área-1")).toBeVisible();

    await expect(
      page.getByRole("button", { name: "icon soy Ponto nº 1 Criado em" }),
    ).toBeVisible();
  });
});
